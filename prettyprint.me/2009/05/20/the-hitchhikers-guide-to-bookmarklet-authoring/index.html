<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/11">
<title>The hitchhikers guide to bookmarklet authoring | PrettyPrint.me</title>
<meta name="generator" content="WordPress 3.2" /> <!-- leave this for stats -->
<link rel="alternate" type="application/rss+xml" title="PrettyPrint.me RSS Feed" href="../../../../feed/index.html" />
<link rel="pingback" href="../../../../xmlrpc.php" />
<link rel="stylesheet" type="text/css" media="all" href="../../../../wp-content/themes/retrospective/style.css" />
<!--[if lte IE 7]>
	<link rel="stylesheet" type="text/css" media="all" href="http://prettyprint.me/wp-content/themes/retrospective/ie.css" />
<![endif]-->
<!--[if lte IE 6]>
	<link rel="stylesheet" type="text/css" media="all" href="http://prettyprint.me/wp-content/themes/retrospective/ie6.css" />
<![endif]--> 
<meta name="verify-v1" content="iFkC+FAFtOQ601MZ4pU4juKjv2UEYbdQNeezoVgCUyE=" >
<link rel="alternate" type="application/rss+xml" title="PrettyPrint.me &raquo; The hitchhikers guide to bookmarklet authoring Comments Feed" href="feed/index.html" />
<link rel='stylesheet' id='contact-form-7-css'  href='../../../../wp-content/plugins/contact-form-7/styles747d.css?ver=2.4.5' type='text/css' media='all' />
<script type='text/javascript' src='../../../../wp-includes/js/l10na17a.js?ver=20101110'></script>
<script type='text/javascript' src='../../../../wp-includes/js/jquery/jquery51a2.js?ver=1.6.1'></script>
<script type='text/javascript' src='../../../../wp-content/plugins/google-analyticator/external-tracking.min6fb3.js?ver=6.1.3'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../../xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../../wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='PrettyPrint.me' href='../../../../index.html' />
<link rel='start' title='Hello Pretty World' href='../../17/hello-pretty-world/index.html' />
<link rel='prev' title='Hello Pretty World' href='../../17/hello-pretty-world/index.html' />
<link rel='next' title='Sometimes look on the bright side of life' href='../../21/sometimes-look-on-the-bright-side-of-life/index.html' />
<meta name="generator" content="WordPress 3.2" />
<link rel='shortlink' href='../../../../index0735.html?p=18' />

<!-- All in One SEO Pack 1.6.13.3 by Michael Torbert of Semper Fi Web Design[209,264] -->
<meta name="description" content="I've written several bookmarklets lately so I wanted to write a tutorial/Q&amp;A to help newbees and share what I've learned. Please leave comments if you have" />
<link rel="canonical" href="index.html" />
<!-- /all in one seo pack -->
<meta name="tweetmeme-title" content="The hitchhikers guide to bookmarklet authoring" />
<link rel="stylesheet" href="../../../../wp-content/plugins/wp-syntax/wp-syntax.css" type="text/css" media="screen" />
<!-- Google Analytics Tracking by Google Analyticator 6.1.3: http://ronaldheft.com/code/analyticator/ -->
<script type="text/javascript">
	var analyticsFileTypes = [''];
	var analyticsEventTracking = 'enabled';
</script>
<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-2694026-6']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
</head>

<body>
<div id="header">
<a href="../../../../index.html" title="PrettyPrint.me">
<div id="logo">
<p>by Ran Tavory</p>
</div>
</a>
<div id="top_navlist">
<ul id="navlist">
<li class="page_item page-item-213"><a href="../../../../about-2/index.html" title="About.me">About.me</a></li>
<li class="page_item page-item-368"><a href="../../../../contact/index.html" title="Contact">Contact</a></li>
</ul>
</div><!--//top_navlist-->
</div><!--//header-->

<div id="container"><!--container -->
<!-- #content -->
<div id="content">

    <div class="post" id="post-18">
      <h1>The hitchhikers guide to bookmarklet authoring</h1>
      <p class="postmetadata"> </p>
      
      <div class="entry">
        <div class="tweetmeme_button" style="float: right; margin-left: 10px;"><a class="tm_button" rel="&amp;style=normal&amp;b=2" href="index.html"></a></div>
<p>I&#8217;ve written several <a href="http://en.wikipedia.org/wiki/Bookmarklet">bookmarklets</a> lately so I wanted to write a tutorial/Q&amp;A to help newbees and share what I&#8217;ve learned. Please leave comments if you have questions or you think I got something wrong and good luck with your first bookmarklet.</p>
<p><img class="alignnone size-full wp-image-59" title="Count Bookmarklet" src="../../../../wp-content/uploads/2009/05/picture-1.png" alt="Count Bookmarklet" width="371" height="164" /></p>
<h5>What are bookmarklets?, <em><br />
</em></h5>
<p>Bookmarklets are small plugins/extensions to your browser. They are called that way because they&#8217;re implemented using the browser&#8217;s built-in <em>Bookmarks</em> mechanism (although IE uses a different terminology, <em>Favorites</em>, they are still called bookmarklets even in IE jargon). Example bookmarklets are <a href="http://charcount.appspot.com/">Count</a> which I authored which counts characters of the text you select. There are plenty of other useful <a href="http://www.bmlet.com/Bookmarklets/">bookmarklet examples here</a> as well.</p>
<h5>How to install a bookmarklet?</h5>
<p>Bookmarklet&#8217;s don&#8217;t really require installation. They are simply links you can add to your bookmarks toolbar. There are several ways to do that (depending on your OS and browser), so here&#8217;s a short explanation that tries to catch them all.</p>
<ul>
<li>Right click the bookmarklet link</li>
<li>Select &#8220;Bookmark this link&#8221; (on FF) or similar wording in IE/other browsers</li>
<li>That&#8217;s all, really</li>
</ul>
<p>Now that your bookmarklet is installed, simply click it to use it. For example if you&#8217;ve installed the Count bookmarklet, when you want to count characters simply click the bookmark. So, bookmarklets are best described as &#8220;additional browser buttons&#8221;.</p>
<p>One tweak is that some browsers tend to hide their bookmarks folder, so you have to configure your browser to show it so you have all buttons at hand and don&#8217;t have to click through the bookmarks toolbar in order to get to them. It&#8217;s usually done by either right clicking the navigation bar area or similar technique.</p>
<p>A lot of browsers simply let you drag and drop the bookmarklet to the bookmarks toolbar, so that&#8217;s much easier.</p>
<p>There&#8217;s also a video I found that explains how to install (a different) bookmarklet <a href="http://blog.sharinglinks.com/video-how-to-install-bookmarklet-into-firefox/34/">here</a>.</p>
<h5>How to write a bookmarklet?</h5>
<p>Alright, let&#8217;s get down to business  and write some software!</p>
<p>This is your first bookmarklet: <a href="javascript:alert(&quot;Hello first bookmarklet world&quot;)">Say hello</a> and here&#8217;s the code:</p>
<p><code>&lt;a href="javascript:alert("Hello first bookmarklet world")"&gt;Say hello&lt;/a&gt;</code></p>
<p>That&#8217;s easy, right? All you have to do is add a link at your web page and set the href of that link to javascript:&#8230; We&#8217;ll talk about this javascript: more later. Now all your users have to do is add this link to their bookmarks and that&#8217;s it.</p>
<h5>What does javascript: stand for?</h5>
<p>A URL is comprised of several sections. For example in http://www.google.com/ we have www.google.com as the host name and http as <strong>the protocol</strong>. Browsers know all sorts of protocols, to name a few http, https, ftp, irc and yes, javascript as well. Sometimes a browser relayes a protocol to the operating system, such as the case wtih irc or ed2k but at least for http, https and javascript the browser handles them by itself. So when you have an &lt;a href=&#8217;javascript:&#8230;&#8221;&gt; it actually tells the browser to run javascript when the user clicks on that link. A simple extension to this is what makes bookmarklet so powerful &#8211; if you have a bookmark wtih a link that starts with javascript: as its protocol, the browser will, instead of navigating to a different page, simply run that javascript <strong>in the context of the current page</strong>. This is great because now you&#8217;re able to add functionality to other pages. For example , you may count characters on any page you visit. Many bookmarklets operate on the current page, but they strictly don&#8217;t have to, they can be independent of the page such as the Say hello bookmarklet above, which simply doesn&#8217;t care about what page the user is currently browsing, but to me the real power of bookmarklets is to be able to interact with the page.</p>
<p>You may know about plugins/extensions/toolbars, which in many cases also operate on the &#8220;current page&#8221;, so if you&#8217;re wondering what&#8217;s the difference between an extension and a bookmarklet, that&#8217;s a good question, but we&#8217;ll get to that later.</p>
<h5>Let&#8217;s write a non-trivial bookmarklet</h5>
<p>In the previous example we had a simple bookmarklet that only says hello. That&#8217;s cute, but not that useful. Let&#8217;s do a real one then, one that counts the number of words on the current page.</p>
<p>First, let&#8217;s write just the javascript code, run it and only then turn it into a bookmarklet. I like to use firebug for writing short snippets of code and testing them, so just copy the code below, paste it into firebug console and run it.</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #003366; font-weight: bold;">var</span> t <span style="color: #339933;">=</span> document.<span style="color: #660066;">body</span>.<span style="color: #660066;">innerHTML</span><span style="color: #339933;">;</span> <span style="color: #006600; font-style: italic;">// Gets all body content</span>
t <span style="color: #339933;">=</span> t.<span style="color: #660066;">replace</span><span style="color: #009900;">&#40;</span><span style="color: #009966; font-style: italic;">/&lt;(.|\n)*?&gt;/g</span><span style="color: #339933;">,</span><span style="color: #3366CC;">''</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #006600; font-style: italic;">// Removes all html tags</span>
t <span style="color: #339933;">=</span> t.<span style="color: #660066;">replace</span><span style="color: #009900;">&#40;</span><span style="color: #009966; font-style: italic;">/\s+/g</span><span style="color: #339933;">,</span><span style="color: #3366CC;">' '</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #006600; font-style: italic;">// Crunch consecutive whitespaces</span>
<span style="color: #000066;">alert</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'Length: '</span> <span style="color: #339933;">+</span> t.<span style="color: #660066;">split</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">' '</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">length</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #006600; font-style: italic;">// split by spaces and count length</span></pre></div></div>

<p>Now stay tuned because this is important. To turn this piece of javascript code to a bookmarklet we&#8217;ll need to apply several transformations, so let&#8217;s do them one step at a time.</p>
<p>1. First step is trivial, remove comments.</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #003366; font-weight: bold;">var</span> t <span style="color: #339933;">=</span> document.<span style="color: #660066;">body</span>.<span style="color: #660066;">innerHTML</span><span style="color: #339933;">;</span>
t <span style="color: #339933;">=</span> t.<span style="color: #660066;">replace</span><span style="color: #009900;">&#40;</span><span style="color: #009966; font-style: italic;">/&lt;(.|\n)*?&gt;/g</span><span style="color: #339933;">,</span><span style="color: #3366CC;">''</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
t <span style="color: #339933;">=</span> t.<span style="color: #660066;">replace</span><span style="color: #009900;">&#40;</span><span style="color: #009966; font-style: italic;">/\s+/g</span><span style="color: #339933;">,</span><span style="color: #3366CC;">' '</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #000066;">alert</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'Length: '</span> <span style="color: #339933;">+</span> t.<span style="color: #660066;">split</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">' '</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">length</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></div></div>

<p>2. Next we need to crunch it all to one line. Bookmarks should not have newlines in them (although some browsers are OK with that, let&#8217;s play it clean)</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #003366; font-weight: bold;">var</span> t <span style="color: #339933;">=</span> document.<span style="color: #660066;">body</span>.<span style="color: #660066;">innerHTML</span><span style="color: #339933;">;</span> t<span style="color: #339933;">=</span> t.<span style="color: #660066;">replace</span><span style="color: #009900;">&#40;</span><span style="color: #009966; font-style: italic;">/&amp;lt;(.|\n)*?&amp;gt;/g</span><span style="color: #339933;">,</span><span style="color: #3366CC;">''</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> t <span style="color: #339933;">=</span> t.<span style="color: #660066;">replace</span><span style="color: #009900;">&#40;</span><span style="color: #009966; font-style: italic;">/\s+/g</span><span style="color: #339933;">,</span><span style="color: #3366CC;">' '</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #000066;">alert</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'Length: '</span> <span style="color: #339933;">+</span> t.<span style="color: #660066;">split</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">' '</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">length</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></div></div>

<p>Later we&#8217;ll introduce an automated tool that does all that, but for now it&#8217;s instructive that you do it yourself.</p>
<p>3. Next, wrap it all in a function construct. This is the most importance point, so pay attension.</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span><span style="color: #003366; font-weight: bold;">var</span> t <span style="color: #339933;">=</span> document.<span style="color: #660066;">body</span>.<span style="color: #660066;">innerHTML</span><span style="color: #339933;">;</span> t<span style="color: #339933;">=</span> t.<span style="color: #660066;">replace</span><span style="color: #009900;">&#40;</span><span style="color: #009966; font-style: italic;">/&amp;lt;(.|\n)*?&amp;gt;/g</span><span style="color: #339933;">,</span><span style="color: #3366CC;">''</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> t <span style="color: #339933;">=</span> t.<span style="color: #660066;">replace</span><span style="color: #009900;">&#40;</span><span style="color: #009966; font-style: italic;">/\s+/g</span><span style="color: #339933;">,</span><span style="color: #3366CC;">' '</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #000066;">alert</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'Length: '</span> <span style="color: #339933;">+</span> t.<span style="color: #660066;">split</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">' '</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">length</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span></pre></div></div>

<p>Let&#8217;s talk about what just happened here. We wrapped the code inside this weird construct <em>(function(){&#8230;})()</em>. What does it mean?</p>
<p>What you see here is an <strong>anonymous function</strong> definition followed immediately by the function execution. JavaScript is great in allowing anonymous functions and what we get from it is two important things. First we get namespace safety &#8211; if there was another variable on the page named t if will not get overrun. Bookmarklet need to be good citizens and if you run over the local page variable no one will want to use your bookmarklet so you have to be careful. Keep in mind that you have no control over what page your bookmarklet is run at, so you don&#8217;t know whether that page has already defined a variable named t or not. Now, you could have gotten away with using __my_ugly_bookmarklet_unique_variable_name as a somewhat unique var name on the page in hope no one gets as smart as you making up var names, but c&#8217;mon, this is way un-elegant. And there&#8217;s more.</p>
<p>The second thing you get from using the anonymous function construct is even more important &#8211; A single statement. Remember the talk about protocols before, the javascript: protocol? So, the thing is that javascript: protocol may only accept one statement. So if the statement is a simple alert() that&#8217;s fine but if your program has more than a single statement, (and that&#8217;s why we call them non-trivial) then you need to wrap all the statements in one big block. That block is this function construct.</p>
<p>So, let&#8217;s get back to the function construct and see what we have.</p>
<p>First, we have an anonymous function</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>...<span style="color: #660066;">code</span>...<span style="color: #009900;">&#125;</span></pre></div></div>

<p>Next, we wrap this function definition in braces to make sure associativity works for us:</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>...<span style="color: #660066;">code</span>...<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span></pre></div></div>

<p>And next, we invoke this function</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>...<span style="color: #660066;">code</span>...<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span></pre></div></div>

<p>By invoking the function we effectively run the code inside the function, which is exactly what we need. OK, so that was the hard part, now the easy part.</p>
<p>4. Next, add an &lt;a href=&#8221;javascript:&#8221; to it</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #339933;">&lt;</span>a href<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;javascript:(function(){var t = document.body.innerHTML; t= t.replace(/&amp;lt;(.|<span style="color: #000099; font-weight: bold;">\n</span>)*?&amp;gt;/g,''); t = t.replace(/<span style="color: #000099; font-weight: bold;">\s</span>+/g,' '); alert('Length: ' + t.split(' ').length);})()&quot;</span><span style="color: #339933;">&gt;</span>Count words on page<span style="color: #339933;">&lt;/</span>a<span style="color: #339933;">&gt;</span></pre></div></div>

<p>So, with step 4 you have your bookmarklet ready. Let&#8217;s summarize all steps so far</p>
<p>0. Write the javascript code for the bookmarklet. This is the heart of your application where all logic goes. All the rest are more or less trivial plumbing once you get the hang of it. I use Firebug for testing small snippets of code, and usually just save the javascript I develop in a local file.</p>
<p>1. remove comments</p>
<p>2. crunch into one line</p>
<p>3. wrap in (function(){&#8230;})()</p>
<p>4. Add the &lt;a href=&#8221;javascript code on an HTML page (this is optional by the way, only if you want other ppl to see your bookmarklet)</p>
<p>About code crunching, otherwise known as <strong>javascript-minification </strong>or<strong> compression</strong>, there are automated tools to help you do that. They remove comments, remove newlines and extra whitespaces, so what I do is keep the js file well formatted and only when I want to deploy it, I run it through the minifier. An online minifier version is also available, which is quite handy <a href="http://fmarcia.info/jsmin/test.html">here</a> and a downloadable minifier from Yahoo <a href="http://developer.yahoo.com/yui/compressor/">here<br />
</a></p>
<p>Now you are ready to write your first bookmarklet. In the next sections we&#8217;ll dig into more advanced techniques and some meta discussions.</p>
<h5>Bookmarklets vs. extensions</h5>
<p>A short recap: Bookmarklets are small extensions to the browser&#8217;s functionality implemented as a simple bookmark. What are browser extensions then (also called add-ons, sometimes plugins, sometimes toolbars etc)? They are also extensions to the common browser functionality. There are dozens of examples extensions such as the Google Toolbar, Yahoo, MSN and so many more. So what is the difference b/w a bookmarklet and an extension?</p>
<p>Well, there are many differences but I&#8217;ll only talk about a few which I think matter the most and would hopefully help you determine whether you want to write a bookmarklet or an extension</p>
<p><strong>Functionality</strong>. Functionality wise I think extensions win. Browser extensions can do so much more than bookmarklets. They can open a sidebar, they can have as many buttons as they like (instead of  just one), they can have more than just buttons, they can have text boxes, graphics, control the mouse cursor ans so much more. A user can play with the extension settings to personalize it etc. Bookmarklets are much simpler and don&#8217;t provide all that rich functionality. They are bookmarks, and they will always look like bookmarks, you can&#8217;t make them use a logo (except for your site&#8217;s favicon, but that&#8217;s lame and doesn&#8217;t work by default on all browsers). Functionality wise, extensions win. But wait, there&#8217;s more.</p>
<p><strong>Ease of development.</strong> If you&#8217;ve read this tutorial you can write a bookmarklet. It&#8217;s that easy. To write a bookmarklet you need to know about the usual web stuff, javascript, css, html, but that&#8217;s all, no need to learn something specific except from what is in this blog. Extensions are a whole different story. Firefox extensions, which are relatively easy to make compared to IE toolbars make you learn about XUL and about the special firefox extensions registry, they make you create an xpi, an installable version etc. IE is much much worse in that sense. Now, all that is definitly possible of course, people have been doing it for a long time, but you have to admit this is order of magnitude more complex than the javascript, html and css you already know. In ease of development bookmarklets win.</p>
<p><strong>Interoperability</strong>. When authoring a bookmarklet, just like authoring a web site, you write them for all browsers. All browsers have support for bookmarks, hence all browsers support bookmarklets. OTOH, not all browsers support extensions and those that do (IE, FF) have a whole different structure for doing that. If you choose the bookmarklet way, by definition you develop for all platforms. If you choose the extensions way you&#8217;d have to write one extension for IE (good luck with that), one for FF, you can&#8217;t write extensions for Safari, which happens to be my favorite browser, none for Opera and I rest my case. Interoperability wise, bookmarklets win.</p>
<p><strong>User-friendliness</strong>. I don&#8217;t know. I think some users are more confirmable with extensions just because they are one-click to install (or several clicks) whereas bookmarklets require you to add a bookmark, which as silly as it may sound, some ppl are having real hard time with that. So I think the installation process of toolbars is better at least for some users. OTOH, I think advanced users much prefer bookmarklets b/c they feel more in control when installing them. When I install a browser extension I think very hard on whether this extension is going to slow my browser down, or wheather it&#8217;s going to change my layout, or whether it&#8217;s going to take some preceaus browser real-estate. As a minimalist I prefer bookmarkletrs as I&#8217;m in full control &#8211; they hardly take up space, they can&#8217;t operate and slow my browser down unless I click them, so I&#8217;m in control. But I see why some users prefer extensions. Let&#8217;s call it a tie then.</p>
<p>The bottom line is this: for your applicaton you should determine whether to use an extension or a bookmarklet according to the following criteria:</p>
<ul>
<li>What functionality do you want to provide? Some things just can&#8217;t be done using a bookmarklet.</li>
<li>What browsers would you like to support? Not all browsers support extensions, and even those who do require you to rewrite your code for them</li>
<li>Do you have time to develop an extension? In most cases extensions are order of magnitude harder to implement.</li>
<li>What is your audience? It is going to be comfortable with a bookmarklet? Is it going to be comfortable with an extension? This is sometimes hard to figure out, BTW, but that&#8217;s how life is&#8230;</li>
</ul>
<h5>Advanced: Loading code from remote server</h5>
<p>In the <a href="http://charcount.appspot.com/">Count</a> bookmarklet I authored I use jQuery to display a nice floating window and animations. I chose to use jQuery and animations make the whole thing look nicer. I could have gotten through with a simple alert() message but it just didn&#8217;t feel right.</p>
<p>Now, the challenge is twofold:</p>
<ul>
<li>bookmarklets have limited space in them, which means you can&#8217;t crunch so much code into them, and definitly not the whole jQuery library. I don&#8217;t remember what the exact limitation is and I&#8217;d bet different browsers have different limitation, but it&#8217;s safe to assume that 1024 chars are about the max since this is a normal limitation HTTP imposes in URLs. Anyway, even if it was 2000, 4000 or more that wouldn&#8217;t have been enough.</li>
<li>Say you want  to upgrade your bookmarklet &#8211; fix a bug or add a feature. If all the code would have been implemented inside the bookmarklet itself, you&#8217;d have to ask all your users who already installed that to remove and reinstall, then you&#8217;re in big trouble.</li>
</ul>
<p>So, what you want to do is have a bookmarklet that actually loads javascriopt to the page from a remote server. That way it&#8217;s simple to ugdate your bookmarklet.</p>
<p>To load javascript to a page that&#8217;s actually already fully loaded we use a technique called <strong>dynamic script injection</strong>, which is common to other applications such as jsonp and here&#8217;s how it works:</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #003366; font-weight: bold;">var</span> s <span style="color: #339933;">=</span> document.<span style="color: #660066;">createElement</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'script'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #006600; font-style: italic;">// Create a script dom element</span>
s.<span style="color: #660066;">setAttribute</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'src'</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">'http://charcount.appspot.com/s/jquery.js'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #006600; font-style: italic;">// Set the element source to the js file you want to load</span>
s.<span style="color: #660066;">setAttribute</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'type'</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">'text/javascript'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
document.<span style="color: #660066;">body</span>.<span style="color: #660066;">appendChild</span><span style="color: #009900;">&#40;</span>s<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #006600; font-style: italic;">// attaching the element to the body (or to head) results in the browser loading the script and executing it. That's just how browser magic works, which is cool... all browsers do that!</span></pre></div></div>

<p>So the trick is to attach a &lt;script&gt; dom element to the head (or body) which results in browser execution. How cool is that? By the way, don&#8217;t try to use document.write(&#8220;&lt;script..&#8221;), it will not work. Once a page is fully loaded calling document.write simply messes everything up and you&#8217;re likely to find your browser unstble if you choose to do that (beleive me, I tried <img src='../../../../wp-includes/images/smilies/icon_wink.gif' alt=';)' class='wp-smiley' /> )</p>
<p>Loading a script from a remote server is very cool and it opens up interesting possibilities. You&#8217;re no longer bound to writing very very compact code and you can use 3rd party libraries, so that&#8217;s awesome. There are, however. a small tradeoff and a few gotchas:</p>
<ul>
<li>The tradeoff is in performance. If all your code is local the browser runs it very fast whereas if you have to load remote resources depending on your server availability, this may be slower. It&#8217;s usually not a big deal, but I had to mention this.</li>
<li>You need to have a server. Or at least something static that can serve javascript.</li>
<li>Gotcha: be careful not to load your script more than once. If the user clicks on your bookmarklet again and again you don&#8217;t want to load your js files over and over again. There&#8217;s a simple way to guard agains this, look at the example below.</li>
</ul>
<p>To prevent your scripts from being loaded more than once you make use a guard, a variable or a page element that gets initialized in the js file and the bookmarklet code checks for its existence. Here&#8217;s an example from the Count bookmarklet:</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;">javascript<span style="color: #339933;">:</span><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span><span style="color: #000066; font-weight: bold;">if</span><span style="color: #009900;">&#40;</span>document.<span style="color: #660066;">getElementById</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'__wc_display'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>__wc_refresh<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>return<span style="color: #009900;">&#125;</span> <span style="color: #006600; font-style: italic;">// That was the guard. The rest of the code will load the js files</span>
&nbsp;
window.__wc_base<span style="color: #339933;">=</span><span style="color: #3366CC;">'http://charcount.appspot.com/'</span><span style="color: #339933;">;</span>var<span style="color: #339933;">%</span>20d<span style="color: #339933;">=</span>document<span style="color: #339933;">;</span>var<span style="color: #339933;">%</span>20s<span style="color: #339933;">=</span>d.<span style="color: #660066;">createElement</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'script'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>s.<span style="color: #660066;">setAttribute</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'src'</span><span style="color: #339933;">,</span>__wc_base<span style="color: #339933;">+</span><span style="color: #3366CC;">'s/jquery.js'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>s.<span style="color: #660066;">setAttribute</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'type'</span><span style="color: #339933;">,</span><span style="color: #3366CC;">'text/javascript'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>d.<span style="color: #660066;">body</span>.<span style="color: #660066;">appendChild</span><span style="color: #009900;">&#40;</span>s<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>s<span style="color: #339933;">=</span>d.<span style="color: #660066;">createElement</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'script'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>s.<span style="color: #660066;">setAttribute</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'src'</span><span style="color: #339933;">,</span>__wc_base<span style="color: #339933;">+</span><span style="color: #3366CC;">'s/wc.js'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>s.<span style="color: #660066;">setAttribute</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'type'</span><span style="color: #339933;">,</span><span style="color: #3366CC;">'text/javascript'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>d.<span style="color: #660066;">body</span>.<span style="color: #660066;">appendChild</span><span style="color: #009900;">&#40;</span>s<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span></pre></div></div>

<h5>Bookmarklets Dos and Don&#8217;ts</h5>
<p><span style="color: #008000;">DO</span>: Be polite. Remember, you&#8217;re not running your own show here, you&#8217;re only a guest on some other page. Do what you need to do but don&#8217;t stand in the user&#8217;s way and make it use a bookmarklet-block (as if there&#8217;s something like that&#8230; I just made it up, but you get the point &#8211; be polite).</p>
<p><span style="color: #ff0000;">DON&#8217;T</span> mess with user privacy. You&#8217;re a guest, don&#8217;t forget that. NEVER look at cookies. Users trust you when they install, don&#8217;t betray that trust. Both bookmarklets and browser extensions are able to compromise security.</p>
<p><span style="color: #008000;">DO</span>: graceful degregate. In case your server is not up or something else is going wrong, make sure that your bookmarklet leaves the browser in good condition. No javascript errors, no broken page etc.</p>
<p><span style="color: #008000;">DO</span>: Test multiple browsers. It&#8217;s unfortunate, but very common for code to work perfect on one browsr and be completely broken on another. You must test at least the commonly used browsers, it&#8217;s a pain, but it&#8217;s a must.</p>
<p><span style="color: #ff0000;">DONT</span> burn CPU, don&#8217;t leak memory. That&#8217;s true not only for bookmarklets, but is especially true for them. Messing with your own site is one thing, but messing with another site is a whole different story. You&#8217;re a guest, behave!</p>
<p>I hope this tutorial was useful. Pleae feel free to leave cometns if you feel something is missing.</p>
<script type='text/javascript'>
		<!--
		//OBSTART:do_NOT_remove_this_comment
		var OutbrainPermaLink="index.html";
		if(typeof(OB_Script)!='undefined'){OutbrainStart();} else {
		var OB_PlugInVer="7.0.0.0_Regular";;var OB_raterMode="stars";var OB_recMode="rec";var OBITm="1263219542";var OB_Script=true;var OB_langJS="";document.write(unescape("%3Cscript src='http://widgets.outbrain.com/OutbrainRater.js' type='text/javascript'%3E%3C/script%3E"));}
		//OBEND:do_NOT_remove_this_comment
		//-->
		</script>
		      </div>
      <p class="postmetadata2">Published in <a href="../../../../category/uncategorized/index.html" title="View all posts in Uncategorized" rel="category tag">Uncategorized</a><!-- by <php the_author(); ?> -->, May 20th, 2009 <br />
      	</p>
    </div>
    
	<!--
	<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://prettyprint.me/2009/05/20/the-hitchhikers-guide-to-bookmarklet-authoring/"
    dc:identifier="http://prettyprint.me/2009/05/20/the-hitchhikers-guide-to-bookmarklet-authoring/"
    dc:title="The hitchhikers guide to bookmarklet authoring"
    trackback:ping="http://prettyprint.me/2009/05/20/the-hitchhikers-guide-to-bookmarklet-authoring/trackback/" />
</rdf:RDF>	-->

  
<!-- You can start editing here. -->

<div class="boxcomments">




	<h2 id="comments">5 Responses to &#8220;The hitchhikers guide to bookmarklet authoring&#8221;</h2>

	<ol class="commentlist">
	
		
<li class="mycomment" id="comment-3">

			
        <p>Mozila just announced <a href="https://jetpack.mozillalabs.com/" rel="nofollow">https://jetpack.mozillalabs.com/</a> for making extensions development easier. It looks like a good start (still in alpha) but it is still for FF only&#8230;</p>
        
        <img alt='' src='http://0.gravatar.com/avatar/2cdc5c3059c40c76d5ca7bec8d149f9e?s=28&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D28&amp;r=G' class='avatar avatar-28 photo' height='28' width='28' />        
        <p style="margin-bottom:5px;">By <strong>rantav</strong> on <a href="#comment-3" title="">May 21, 2009</a> </p>
        	
        
	</li>
		
		
		
<li class="odd" id="comment-1634">

			
        <p>Firefox has, near as I can tell, NO size limitations on bookmarklets. I&#8217;ve written a full arcade version of Tetris, and the bookmarklet is 27kb. Just design your &#8220;app&#8221; as an HTML &#8220;page&#8221; powered by JavaScript, crunch it, encode the whole thing in base64, and load it as:</p>
<p>javascript:/*Title_and_Credits*/aa=window.open(&#8216;data:text/HTML;base64,<br />
YOURB64HERE&#8217;,&#8221;,&#8217;width=420,height=420,left=0,top=0,scrollbars,resizable,menubar,status,location,toolbar,dependent=yes&#8217;);void 1</p>
<p>Bypasses the whole nested-single-and-double-quotes PITA, too.</p>
        
        <img alt='' src='http://0.gravatar.com/avatar/e4abdf45e9e0c735709268f6036cb998?s=28&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D28&amp;r=G' class='avatar avatar-28 photo' height='28' width='28' />        
        <p style="margin-bottom:5px;">By <strong>Blinky the Hitman</strong> on <a href="#comment-1634" title="">May 22, 2010</a> </p>
        	
        
	</li>
		
		
		
<li class="odd" id="comment-4031">

			
        <p>Thanks a lot for info. Now I can create my own bookmarklets <img src='../../../../wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
        
        <img alt='' src='http://0.gravatar.com/avatar/8699808922bc0e9c62dbf4f834a90ad5?s=28&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D28&amp;r=G' class='avatar avatar-28 photo' height='28' width='28' />        
        <p style="margin-bottom:5px;">By <strong><a href='http://blog.shpyo.net/' rel='external nofollow' class='url'>shpyo</a></strong> on <a href="#comment-4031" title="">Oct 29, 2010</a> </p>
        	
        
	</li>
		
		
		
<li class="odd" id="comment-7552">

			
        <p>Is there a something that can be used to block brawler bookmarklets in game playing?</p>
        
        <img alt='' src='http://0.gravatar.com/avatar/e0f19dfb471cd4148678a851c8e7887b?s=28&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D28&amp;r=G' class='avatar avatar-28 photo' height='28' width='28' />        
        <p style="margin-bottom:5px;">By <strong>Gayle</strong> on <a href="#comment-7552" title="">Apr 26, 2011</a> </p>
        	
        
	</li>
		
		
		
<li class="mycomment" id="comment-7563">

			
        <p>I don&#8217;t know exactly what you mean, but this post is > 2years old so maybe a forum on the subject might be of better help for you.</p>
        
        <img alt='' src='http://0.gravatar.com/avatar/2cdc5c3059c40c76d5ca7bec8d149f9e?s=28&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D28&amp;r=G' class='avatar avatar-28 photo' height='28' width='28' />        
        <p style="margin-bottom:5px;">By <strong>Ran Tavory</strong> on <a href="#comment-7563" title="">Apr 27, 2011</a> </p>
        	
        
	</li>
		
		
		
	</ol>
	
	
	

	<p id="comments-closed">Sorry, comments for this entry are closed at this time.</p>
</div>  
 
 
</div><!-- //content -->

<div id="sidebar"><!-- sidebar -->

<p class="rssfeed"><a class="rsslink" href="../../../../feed/index.html"></a>
<p><a href="http://feeds2.feedburner.com/PrettyPrintMe"><img src="http://feeds2.feedburner.com/~fc/PrettyPrintMe?bg=3069B0&amp;fg=fffdfa&amp;anim=1" height="26" width="88" style="border:0" alt="" /></a></p>
</p>

<h2>Search</h2>
<form method="get" id="searchform" class="search" action="http://prettyprint.me/">
<input type="text" name="s" value="Type keywords and hit enter..." onfocus="if (this.value == 'Type keywords and hit enter...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Type keywords and hit enter...';}" />
</form>

<!--
<h2>Categories</h2>
<ul>
		<li class="cat-item cat-item-1"><a href="http://prettyprint.me/category/uncategorized/" title="View all posts filed under Uncategorized">Uncategorized</a>
</li>
</ul>
-->

<h2>Blog Archives</h2>
<ul>
  	<li><a href='../../../../2011/07/index.html' title='July 2011'>July 2011</a></li>
	<li><a href='../../../../2011/02/index.html' title='February 2011'>February 2011</a></li>
	<li><a href='../../../../2011/01/index.html' title='January 2011'>January 2011</a></li>
	<li><a href='../../../../2010/08/index.html' title='August 2010'>August 2010</a></li>
	<li><a href='../../../../2010/05/index.html' title='May 2010'>May 2010</a></li>
	<li><a href='../../../../2010/04/index.html' title='April 2010'>April 2010</a></li>
	<li><a href='../../../../2010/03/index.html' title='March 2010'>March 2010</a></li>
	<li><a href='../../../../2010/02/index.html' title='February 2010'>February 2010</a></li>
	<li><a href='../../../../2010/01/index.html' title='January 2010'>January 2010</a></li>
	<li><a href='../../../11/index.html' title='November 2009'>November 2009</a></li>
	<li><a href='../../../10/index.html' title='October 2009'>October 2009</a></li>
	<li><a href='../../../09/index.html' title='September 2009'>September 2009</a></li>
	<li><a href='../../../08/index.html' title='August 2009'>August 2009</a></li>
	<li><a href='../../../06/index.html' title='June 2009'>June 2009</a></li>
	<li><a href='../../index.html' title='May 2009'>May 2009</a></li>
</ul>

<!--
<h2>Links</h2>
<ul>
  <li><a href="http://wordpress.org/development/">Development Blog</a></li>
<li><a href="http://codex.wordpress.org/">Documentation</a></li>
<li><a href="http://wordpress.org/extend/plugins/">Plugins</a></li>
<li><a href="http://wordpress.org/extend/ideas/">Suggest Ideas</a></li>
<li><a href="http://wordpress.org/support/">Support Forum</a></li>
<li><a href="http://wordpress.org/extend/themes/">Themes</a></li>
<li><a href="http://planet.wordpress.org/">WordPress Planet</a></li>
</ul>
-->

<!--
<h2>Meta</h2>
<ul>
    <li><a href="http://prettyprint.me/wp-login.php">Log in</a></li>
  <li><a href="http://www.wordpress.org/">WordPress</a></li>
    <li><a href="http://validator.w3.org/check?uri=referer">XHTML</a></li>
</ul>
-->

 


</div> <!--//sidebar  -->

</div><!--//container-->

<div id="footer-container">
	
<div id="footer">

<div id="footerleft">
		<h2>About</h2>
  <p>Restrospective focuses on clean typography and modern colors and design.</p>
  </div>

<div id="footermid">
		<h2>Profiles, Links</h2>
	<ul>
  	<li><a href="http://www.linkedin.com/in/rantav">LinkedIn</a></li>
  	<li><a href="http://tavory.com/">Homepage</a></li>
  	<li><a href="http://twitter.com/rantav">Twitter</a></li>
  	<li><a href="http://reversim.com/">(Hebrew podcast I run) רברס עם פלטפורמה</a></li>
  	<li><a href="http://friendfeed.com/rantav">FriendFeed</a></li>
  	<li><a href="http://gbsheli.com/">Google Blog Sheli (my older blog, mostly Hebrew)</a></li>
  	<li><a href="http://www.facebook.com/people/Ran-Tavory/543122173">Facebook</a></li>
  </ul>
  </div>

<div id="footerright">
	<!--
	<h2>Recent Readers</h2>
-->
  <!--	Paste JavaScript from MyBlogLog or other services -->

  </div>

</div><!--//footer-->

<div class="copyright">
	Copyright &copy; <a href="../../../../index.html">PrettyPrint.me</a> &middot; All rights reserved.<br />
	
	Powered by <a href="http://wordpress.org/">WordPress</a> and <a href="http://blogbuildingu.com/retrospective">Retrospective theme</a> &middot; Design & code by <a href="http://blogbuildingu.com/">Hendry Lee</a>.

<script type='text/javascript' src='../../../../wp-content/plugins/contact-form-7/jquery.formd20f.js?ver=2.52'></script>
<script type='text/javascript' src='../../../../wp-content/plugins/contact-form-7/scripts747d.js?ver=2.4.5'></script>
<script src="../../../../wp-content/plugins/tweetmeme/button.js" type="text/javascript"></script></div>

</div><!--//footer-container-->

</body>

<!-- Mirrored from prettyprint.me/2009/05/20/the-hitchhikers-guide-to-bookmarklet-authoring/ by HTTrack Website Copier/3.x [XR&CO'2010], Fri, 28 Dec 2012 23:03:44 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
</html>
